## HTTPS

```
传输层安全（TLS）是现已废弃的安全套接字层（SSL）的继任者，是一种加密协议，旨在通过计算机网络提供通信安全。
该协议被广泛用于电子邮件和即时通讯等应用，但它在确保 HTTPS安全方面的应用仍然是最公开的。
由于应用程序可以使用或不使用 TLS（或SSL）进行通信，因此客户（浏览器）有必要要求服务器建立 TLS 连接。
```

- `https` 实际就是讲 `http` 通信放到 `SSL` 之上进行的。
- `SSL` (Secure Socket Layer：安全套接字层) 是一种通过公钥基础设施为通信双方提供数据加密和身份验证的协议。之后用 IETF(Internet Engineering Task Force：互联网工程任务组)接受并将其改名为 `TLS` (Transport Layer Security：传输层安全协议)。  
- `SSL` 和 `TLS` 两者可以视为同一个东西不同阶段的产物
- 对于通过 HTTPS 建立的安全连接，需要进行另一次握手。这种握手（TLS协商）决定了哪个密码将被用于加密通信，验证服务器，并在开始实际的数据传输之前建立一个安全的连接。


1. `客户端 hello` 浏览器向服务器发送一条信息，其中包括它所支持的TLS版本和密码套件，以及一串随机字节，称为 客户端随机数。
2. `服务器 hello 和证书` 服务器发回一条信息，其中包括服务器的SSL证书、服务器选择的密码套件和服务器随机数，这是服务器生成的另一个随机字节串。
3. `认证` 浏览器会向颁发证书的机构核实服务器的 SSL 证书。这样，浏览器就可以确定服务器就是它所说的那个人。
4. `预主密码` 浏览器会再发送一串随机的字节，称为主密钥，用浏览器从服务器的 SSL 证书上获取的公钥进行加密。主密码只能由服务器用私钥解密。
5. `使用私钥` 服务器解密预主密码。
6. `创建会话密钥` 浏览器和服务器从客户端随机数、服务器随机数和预主密码中生成会话密钥。
7. `客户端完成` 浏览器向服务器发送一个消息，说它已经完成。
8. `服务器完成` 服务器向浏览器发送一个消息，表示它也完成了。
9. `安全对称加密实现` 握手完成，通信可以继续使用会话密钥。
   ```
   如果已经建立了一个使用 HTTPS 协议的连接，那么其他的 HTTPS 请求会复用之前的 SSL/TLS 会话状态（Session State），
   从而可以减少 SSL/TLS 协议的重复握手过程和密钥交换过程，提高加密效率和性能。具体来说，HTTPS 的 SSL/TLS 握手过程中，
   服务器会在握手的最后一步发送一个 Finished 消息，该消息包含了之前握手阶段所协商的对称密钥，
   之后，这个对称密钥会被保存在客户端和服务器端的 SSL/TLS 会话状态中，
   并被用来加密和解密下一个请求和响应的数据。当客户端再次发起新的 HTTPS 请求时，会尝试寻找已经存在的 SSL/TLS 会话状态，
   如果找到了匹配的会话状态，则会直接使用其中的对称密钥进行加密和解密操作，避免了握手和密钥交换过程，提高了传输效率和安全性。

   ```
